import{K as v,m as f,j as t}from"./app-0c5FR7Uu.js";import{B as y,a as N}from"./constants-Cxi3XqCn.js";import{c as j}from"./utils-DvmwGg_w.js";import{K as w,L as k}from"./chunk-4SMPYVK4-D8boFYBv.js";import{i as s}from"./chunk-HJTJQZF3-pEocXB3-.js";import{t as D}from"./chunk-ORPGD37S-B3-0A5tV.js";import{s as l,l as o}from"./chunk-7JXO3E7I-CVG-wxOq.js";import{b}from"./chunk-KCYYJJH4-BrXOhzVf.js";import"./chunk-SLABUSGS-B3_7zFLl.js";import"./useDialog-DDVQ5bQn.js";import"./useFocusRing-CD4N2T_R.js";import"./chunk-XPO5AVRM-DPbOQERC.js";import"./index-CokAva9Y.js";import"./features-animation-Da5nnqfS.js";import"./chunk-K6DFORPN-BZFrrvwL.js";import"./useMenuTriggerState-DwpXiAit.js";function U({customer:r,onClose:n}){var g,p,c,m,u,h,x;const{packages:i}=v().props,a=f({name:r.name,customer_id:r.customer_id,status:r.status,address:r.address,npwp:r.npwp,package_id:((p=(g=r.package)==null?void 0:g.id)==null?void 0:p.toString())||"",coordinates:r.coordinate?{latitude:r.coordinate.split(",")[0],longitude:r.coordinate.split(",")[1]}:{latitude:"",longitude:""},phone:r.phone,join_date:r!=null&&r.join_date?r.join_date.split("T")[0]:"",bill_date:((c=r==null?void 0:r.bill_date)==null?void 0:c.toString())||"",email:r.email||""}),_=e=>{e.preventDefault(),a.clearErrors(),console.log(a.data),a.data.name||a.setError("name","Nama customer wajib diisi"),a.data.address||a.setError("address","Alamat wajib diisi"),a.data.npwp||a.setError("npwp","NPWP/NIK wajib diisi"),a.data.phone||a.setError("phone","No. Telepon wajib diisi"),a.data.package_id||a.setError("package_id","Paket wajib dipilih"),a.data.join_date||a.setError("join_date","Tanggal bergabung wajib diisi"),a.data.bill_date||a.setError("bill_date","Tanggal tagihan wajib diisi"),a.data.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.data.email)&&a.setError("email","Format email tidak valid"),/^[0-9]{10,13}$/.test(a.data.phone)||a.setError("phone","Nomor telepon harus 10-13 digit angka"),!(Object.keys(a.errors).length>0)&&a.put(route("customers.update",r.id),{onSuccess:()=>{n()},onError:d=>{console.error("Validation errors:",d)}})};return t.jsx("div",{className:"mx-auto mt-5 max-h-[75vh] w-full overflow-y-auto rounded-2xl bg-white text-slate-800 dark:bg-gray-900 dark:text-gray-100",children:t.jsxs("form",{onSubmit:_,className:"space-y-8 px-5 pb-5",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Data Diri"})}),t.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[t.jsx(s,{label:"Nama Customer",type:"text",id:"name",value:a.data.name,onChange:e=>a.setData("name",e.target.value),isInvalid:!!a.errors.name,errorMessage:a.errors.name}),t.jsx(s,{label:"ID Pelanggan",type:"text",id:"customer_id",value:a.data.customer_id,onChange:e=>a.setData("customer_id",e.target.value),isInvalid:!!a.errors.customer_id,errorMessage:a.errors.customer_id}),t.jsx(s,{label:"Email",type:"email",id:"email",value:a.data.email,onChange:e=>a.setData("email",e.target.value),placeholder:"opsional",isInvalid:!!a.errors.email,errorMessage:a.errors.email}),t.jsx(s,{label:"No. NPWP / NIK",type:"number",id:"tax_number",value:a.data.npwp,onChange:e=>a.setData("npwp",e.target.value),isInvalid:!!a.errors.npwp,errorMessage:a.errors.npwp}),t.jsx(s,{label:"No. Telepon",type:"text",id:"phone",value:a.data.phone,onChange:e=>a.setData("phone",e.target.value),isInvalid:!!a.errors.phone,errorMessage:a.errors.phone})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Alamat"})}),t.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[t.jsx(D,{label:"Alamat",id:"address",value:a.data.address,onChange:e=>a.setData("address",e.target.value),rows:3,isInvalid:!!a.errors.address,errorMessage:a.errors.address}),t.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[t.jsx(s,{label:"Latitude",type:"text",id:"latitude",placeholder:"opsional",value:a.data.coordinates.latitude,onChange:e=>a.setData("coordinates",{...a.data.coordinates,latitude:e.target.value}),isInvalid:!!((m=a.errors.coordinates)!=null&&m.latitude),errorMessage:(u=a.errors.coordinates)==null?void 0:u.latitude}),t.jsx(s,{label:"Longitude",type:"text",id:"longitude",placeholder:"opsional",value:a.data.coordinates.longitude,onChange:e=>a.setData("coordinates",{...a.data.coordinates,longitude:e.target.value}),isInvalid:!!((h=a.errors.coordinates)!=null&&h.longitude),errorMessage:(x=a.errors.coordinates)==null?void 0:x.longitude})]})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Langganan"})}),t.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[t.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[t.jsx(w,{label:"Tanggal Berlangganan",id:"join_date",value:a.data.join_date?k(a.data.join_date):null,onChange:e=>a.setData("join_date",e?`${e.year}-${String(e.month).padStart(2,"0")}-${String(e.day).padStart(2,"0")}`:""),isInvalid:!!a.errors.join_date,errorMessage:a.errors.join_date,showMonthAndYearPickers:!0,selectorButtonPlacement:"start"}),t.jsx(l,{label:"Tanggal Tagihan",id:"bill_date",value:a.data.bill_date,onChange:e=>a.setData("bill_date",e.target.value),isInvalid:!!a.errors.bill_date,errorMessage:a.errors.bill_date,placeholder:"Pilih Tanggal",selectedKeys:a.data.bill_date?[a.data.bill_date]:[],children:Array.from({length:y},(e,d)=>d+1).map(e=>t.jsx(o,{textValue:e.toString(),children:e},e.toString()))})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(l,{label:"Paket",id:"package_id",value:a.data.package_id,selectedKeys:[a.data.package_id],onChange:e=>a.setData("package_id",e.target.value),isInvalid:!!a.errors.package_id,errorMessage:a.errors.package_id,placeholder:"Pilih Paket",children:i==null?void 0:i.map(e=>t.jsxs(o,{textValue:`${e.name} - ${j(e.price)}`,children:[e.name," - ",j(e.price)]},e.id))}),t.jsx(l,{label:"Status",id:"status",value:a.data.status,selectedKeys:[a.data.status],onChange:e=>a.setData("status",e.target.value),isInvalid:!!a.errors.status,errorMessage:a.errors.status,isDisabled:!0,children:N.map(e=>t.jsx(o,{textValue:e.label,children:e.label},e.value))})]})]}),t.jsx("p",{className:"ml-2 text-xs text-red-500",children:"* Tanggal tagihan akan diulang setiap bulan"})]}),t.jsxs("div",{className:"flex justify-end gap-3 border-t border-gray-200 pt-4",children:[t.jsx(b,{onPress:n,color:"default",children:"Batal"}),t.jsx(b,{type:"submit",disabled:a.processing,color:"primary",children:a.processing?"Menyimpan...":"Simpan"})]})]})})}export{U as default};
