import{m as x,K as _,j as o,p as r}from"./app-0c5FR7Uu.js";import{i as j}from"./chunk-HJTJQZF3-pEocXB3-.js";import{b as i}from"./chunk-KCYYJJH4-BrXOhzVf.js";import"./chunk-K6DFORPN-BZFrrvwL.js";import"./chunk-SLABUSGS-B3_7zFLl.js";import"./useFocusRing-CD4N2T_R.js";const w=({onClose:a,onDuplicateClick:c})=>{const{data:p,setData:m,post:d,processing:f,errors:n}=x({file:null}),{flash:u}=_().props;console.log("props import",u);const h=t=>{if(t.preventDefault(),!p.file){r({title:"Error",description:"Silakan pilih file terlebih dahulu",color:"danger"});return}d(route("customers.import"),{onSuccess:e=>{console.log("Flash data inside onSuccess (from page object):",e.props.flash);const s=e.props.flash,l=s.duplicate_customers_info===null||s.duplicate_customers_info.length===0?"File berhasil dibaca":`Terdapat ${s.duplicate_customers_info.length} duplikat data`;r({title:"Import Sukses",description:l,color:"success",timeout:5e3,endContent:s.duplicate_customers_info!==null&&s.duplicate_customers_info.length>0&&o.jsx(i,{size:"sm",color:"warning",onPress:c,children:"Lihat Detail"})}),a()},onError:e=>{console.log("error import",e),e.import_errors?(Array.isArray(e.import_errors)?e.import_errors:[e.import_errors]).forEach(l=>{r({title:"Import Customer Gagal",description:l,color:"danger"})}):r({title:"Error",description:e.message||"Terjadi kesalahan saat membaca file",color:"danger"})}})},g=()=>{window.open("/template/template_customers.xlsx","_blank")};return o.jsx("div",{className:"flex flex-col gap-4 p-5",children:o.jsxs("form",{onSubmit:h,className:"space-y-4",children:[o.jsx(j,{type:"file",id:"file",label:"Pilih file",variant:"flat",radius:"md",color:"primary",accept:".csv, .xlsx, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, .xls",onChange:t=>{var e,s;m("file",((e=t.target.files)==null?void 0:e[0])??null),(s=t.target.files)!=null&&s[0]||r({title:"Error",description:"Silakan pilih file",color:"danger"})},isInvalid:!!n.file,errorMessage:n.file}),o.jsx(i,{color:"default",variant:"flat",size:"sm",onPress:()=>g(),children:"Download Template"}),o.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[o.jsx(i,{onPress:a,color:"default",children:"Batal"}),o.jsx(i,{type:"submit",color:"primary",isLoading:f,children:"Import"})]})]})})};export{w as default};
