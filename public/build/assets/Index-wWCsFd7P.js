import{K as B,r as c,j as a,L as H,S as m,h as p}from"./app-0c5FR7Uu.js";import{u as h,T as K,m as v,a as b,b as N,D as U}from"./Table-BRf1uxgN.js";import{I as V}from"./constants-Cxi3XqCn.js";import{A as J}from"./AuthenticatedLayout-sA9Bkon0.js";import{c as C}from"./utils-DvmwGg_w.js";import{w as R}from"./MagnifyingGlass-DH5TKwAo.js";import{I as q,a as G}from"./Trash-C7j0W3Ta.js";import Q from"./Create-Copa8dBP.js";import W from"./Paid-C7VJWMN8.js";import{s as X,l as Z}from"./chunk-7JXO3E7I-CVG-wxOq.js";import{i as ee}from"./chunk-HJTJQZF3-pEocXB3-.js";import{b as k}from"./chunk-KCYYJJH4-BrXOhzVf.js";import"./chunk-SLABUSGS-B3_7zFLl.js";import"./index-D7ldAl5x.js";import"./useDialog-DDVQ5bQn.js";import"./useFocusRing-CD4N2T_R.js";import"./index-CokAva9Y.js";import"./useMenuTriggerState-DwpXiAit.js";import"./chunk-OTWYT2HS-DPE-1s8j.js";import"./chunk-4SMPYVK4-D8boFYBv.js";import"./chunk-XPO5AVRM-DPbOQERC.js";import"./features-animation-Da5nnqfS.js";import"./chunk-ORPGD37S-B3-0A5tV.js";import"./chunk-K6DFORPN-BZFrrvwL.js";const ae={paid:"bg-green-100 text-green-700",unpaid:"bg-yellow-100 text-yellow-700",cancelled:"bg-red-100 text-red-700"};function _e(){const{invoices:l,filters:r,auth:u}=B().props,{isOpen:O,onOpen:_,onOpenChange:g}=h(),{isOpen:w,onOpen:S,onOpenChange:f}=h(),{isOpen:D,onOpen:P,onOpenChange:j}=h(),[i,x]=c.useState(null),[s,I]=c.useState((r==null?void 0:r.search)||""),[n,M]=c.useState((r==null?void 0:r.status)||"all"),Y=c.useMemo(()=>l.data.filter(e=>{var o;const t=n==="all"||e.status===n,d=!s||e.invoice_id.toLowerCase().includes(s.toLowerCase())||((o=e.customer)==null?void 0:o.name.toLowerCase().includes(s.toLowerCase()));return t&&d}),[l.data,s,n]),T=e=>{x(e),S()},A=()=>{i&&m.delete(route("invoices.destroy",i.id),{onSuccess:()=>{f(),x(null)}})},L=e=>{x(e),P()},y=[{header:"Invoice ID",value:e=>a.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:e.invoice_id||"-"})},{header:"Pelanggan",value:e=>{var t,d,o;return a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"h-8 w-8 overflow-hidden rounded-full bg-gray-100 dark:bg-gray-700",children:a.jsx("img",{src:`https://ui-avatars.com/api/?name=${((t=e.customer)==null?void 0:t.name)||"Customer"}&background=random`,alt:((d=e.customer)==null?void 0:d.name)||"Customer",className:"h-full w-full object-cover"})}),a.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:((o=e.customer)==null?void 0:o.name)||"N/A"})]})}},{header:"Paket",value:e=>{var t;return a.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:((t=e.package)==null?void 0:t.name)||"-"})}},{header:"Harga Paket",value:e=>{var t;return a.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:C(((t=e.package)==null?void 0:t.price)||0)})}},{header:"PPN",value:e=>a.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:e.ppn||"-"})},{header:"Total",value:e=>a.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:C(e.total_amount||0)})},{header:"Jatuh Tempo",value:e=>a.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:p(e.due_date).format("DD MMMM YYYY")})},{header:"Catatan",value:e=>a.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:e.note})},{header:"Periode",value:e=>a.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:p(e.created_at).format("DD MMMM YYYY")})},{header:"Dibuat Oleh",value:e=>{var t;return a.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:((t=e.creator)==null?void 0:t.name)||"N/A"})}},{header:"Dibayar Pada",value:e=>a.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:e.paid_at?p(e.paid_at).format("DD MMMM YYYY"):"-"})},{header:"Status",value:e=>a.jsx("span",{className:`inline-flex rounded-full px-2 py-1 text-xs font-medium ${ae[e.status]}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})}],z=[...y,{header:"Aksi",value:e=>a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.status==="unpaid"&&a.jsx(k,{size:"sm",onPress:()=>L(e),color:"success",className:"text-white",children:"Bayar"}),a.jsx("button",{onClick:()=>T(e),className:"cursor-pointer rounded-lg p-2 text-red-600 transition-colors hover:bg-red-600 hover:text-white",children:a.jsx(G,{className:"h-4 w-4"})})]})}],F=e=>{I(e.target.value),m.get(route("invoices.index"),{search:e.target.value,status:n},{preserveState:!0,replace:!0})},E=e=>{M(e),m.get(route("invoices.index"),{search:s,status:e},{preserveState:!0,replace:!0})},$=e=>{m.get(route("invoices.index"),{page:e,search:s,status:n},{preserveState:!0,replace:!0})};return a.jsxs(J,{children:[a.jsx(H,{title:"Invoices"}),a.jsxs("div",{className:"p-4 lg:p-8",children:[a.jsx("h2",{className:"mb-5 text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Tagihan"}),a.jsxs("div",{className:"mb-6 flex flex-col items-center justify-between gap-4 lg:flex-row",children:[a.jsxs("div",{className:"flex w-full flex-col items-center justify-center gap-4 lg:w-1/2 lg:flex-row",children:[a.jsx(X,{placeholder:"Pilih Status",variant:"bordered",radius:"md",color:"default",value:n,onChange:e=>E(e.target.value),children:[{value:"all",label:"Semua"},...V].map(e=>a.jsx(Z,{textValue:e.label,children:e.label},e.value))}),a.jsx(ee,{startContent:a.jsx(R,{className:"h-4 w-4 text-gray-500"}),type:"text",placeholder:"Cari invoice / nama pelanggan...",value:s,onChange:F,color:"default",variant:"bordered",radius:"md"})]}),u.user.is_admin===1&&a.jsxs(k,{onPress:_,color:"primary",className:"w-full lg:w-fit",children:[a.jsx(q,{className:"h-5 w-5"}),"Buat Tagihan"]})]}),a.jsx(K,{data:Y,column:u.user.is_admin===1?z:y,pagination:{...l,last_page:l.last_page,current_page:l.current_page,onChange:$}}),u.user.is_admin===1&&a.jsxs(a.Fragment,{children:[a.jsx(v,{isOpen:O,onOpenChange:g,size:"sm",children:a.jsx("div",{className:"fixed inset-0 z-50 flex h-screen min-h-screen items-center justify-center overflow-y-auto bg-black/30",children:a.jsxs(b,{className:"relative rounded-2xl bg-white p-0 dark:bg-gray-900",children:[a.jsx(N,{children:a.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Tambah Invoice"})}),a.jsx(Q,{onClose:()=>g()})]})})}),a.jsx(U,{isOpen:w,onClose:f,onConfirm:A,title:"Hapus Invoice",description:"Apakah Anda yakin ingin menghapus invoice ini?"}),a.jsx(v,{isOpen:D,onOpenChange:j,size:"sm",children:a.jsx("div",{className:"fixed inset-0 z-50 flex h-screen min-h-screen items-center justify-center overflow-y-auto bg-black/30",children:a.jsxs(b,{className:"relative rounded-2xl bg-white p-0 dark:bg-gray-900",children:[a.jsx(N,{children:a.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Konfirmasi Pembayaran"})}),i&&a.jsx(W,{invoice:i,onClose:()=>j()})]})})})]})]})]})}export{_e as default};
